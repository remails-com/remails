{
  "db_name": "PostgreSQL",
  "query": "\n            SELECT organization_id AS \"organization_id!\",\n                    project_id AS \"project_id!\",\n                    month AS \"month!\",\n                    statistics AS \"statistics!\"\n            FROM (\n                -- archived statistics\n                SELECT * FROM statistics\n\n                UNION ALL\n\n                -- live statistics\n                SELECT organization_id, project_id, month AS \"month!\",\n                    jsonb_object_agg(status, count_per_status) AS statistics\n                FROM (\n                    SELECT\n                        organization_id, project_id, status,\n                        date_trunc('month', created_at)::date AS month,\n                        COUNT(*) AS count_per_status\n                    FROM messages\n                    GROUP BY\n                        organization_id, project_id, status,\n                        date_trunc('month', created_at)::date\n                )\n                GROUP BY organization_id, project_id, month\n            ) stats\n            WHERE stats.organization_id = $1;\n            ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "organization_id!",
        "type_info": "Uuid"
      },
      {
        "ordinal": 1,
        "name": "project_id!",
        "type_info": "Uuid"
      },
      {
        "ordinal": 2,
        "name": "month!",
        "type_info": "Date"
      },
      {
        "ordinal": 3,
        "name": "statistics!",
        "type_info": "Jsonb"
      }
    ],
    "parameters": {
      "Left": [
        "Uuid"
      ]
    },
    "nullable": [
      null,
      null,
      null,
      null
    ]
  },
  "hash": "067ff62a0e68763b186d6588355a0405daf83b2e178a301aa43b6d902748e1ba"
}
